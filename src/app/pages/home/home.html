<app-onboarding-modal
  *ngIf="showOnboarding"
  (closed)="showOnboarding = false"
></app-onboarding-modal>
<app-ad-banner mode="fake"></app-ad-banner>
<main class="main-grid">
  <section class="section">
    <h2 i18n="@@generatorSectionTitle">1. Gerador Guiado</h2>
    <p i18n="@@generatorSubtitle">Escolha um padrão para gerar a sua regex.</p>
    <div class="options-container">
      <button class="btn" (click)="generateRegex('email', 'default')">
        <lucide-icon name="mail" class="icon"></lucide-icon>
        <span i18n="@@btnEmail">E-mail</span>
      </button>
      <button class="btn" (click)="generateRegex('phone', 'default')">
        <lucide-icon name="phone" class="icon"></lucide-icon>
        <span i18n="@@btnPhone">Telefone</span>
      </button>
      <button class="btn" (click)="generateRegex('cpf', 'default')">
        <lucide-icon name="credit-card" class="icon"></lucide-icon>
        <span i18n="@@btnCPF">CPF</span>
      </button>
      <button class="btn" (click)="generateRegex('date', 'default')">
        <lucide-icon name="calendar-days" class="icon"></lucide-icon>
        <span i18n="@@btnDate">Data</span>
      </button>

      <div class="select-group">
        <label
          for="url-select"
          class="text-gray-600 font-semibold mb-1 block"
          i18n="@@labelURL"
          >URL:</label
        >
        <select
          id="url-select"
          [(ngModel)]="selectedUrlCategory"
          (change)="generateRegex('url', selectedUrlCategory!)"
          class="w-full bg-white border border-gray-300 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"
        >
          <option [value]="null" disabled selected i18n="@@optionChoose">Escolha uma opção</option>
          <option *ngFor="let category of urlCategories" [value]="category">
            <ng-container
              i18n="@@urlOption; select(category)"
              >{{ category === 'optional' ? 'HTTPS:// Opcional' : 'HTTPS:// Obrigatória' }}
            </ng-container>
          </option>
        </select>
      </div>

      <div class="select-group">
        <label
          for="postal-code-select"
          class="text-gray-600 font-semibold mb-1 block"
          i18n="@@labelPostalCode"
          >Código Postal:</label
        >
        <select
          id="postal-code-select"
          [(ngModel)]="selectedPostalCodeCategory"
          (change)="generateRegex('cep', selectedPostalCodeCategory!)"
          class="w-full bg-white border border-gray-300 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"
        >
          <option [value]="null" disabled selected i18n="@@optionChooseCountry">Escolha um país</option>
          <option
            *ngFor="let category of postalCodeCategories"
            [value]="category"
          >
            {{ category | titlecase }}
          </option>
        </select>
      </div>
    </div>
  </section>

  <section class="section">
    <h2 i18n="@@regexGeneratedTitle">2. Regex Gerada</h2>
    <app-regex-display [regex]="generatedRegex"></app-regex-display>

    <h3 i18n="@@explanationTitle">Explicação</h3>
    <div class="regex-explainer-container">
      @for (part of regexParts; track $index) {
      <div class="regex-part">
        <span class="pattern">{{ part.pattern }}</span>
        <span class="explanation">{{ part.explanation }}</span>
      </div>
      }
    </div>
    <br />
    <h3 i18n="@@intuitiveDescriptionTitle">Descrição Intuitiva</h3>
    <p class="regex-description">{{ regexDescription }}</p>
  </section>

  <section class="section">
    <h2 i18n="@@testerTitle">3. Testador</h2>
    <p i18n="@@testerSubtitle">Cole o texto que você quer testar.</p>
    <textarea
      [(ngModel)]="testText"
      (ngModelChange)="validateText()"
      i18n-placeholder="@@testerPlaceholder"
      placeholder="Cole seu texto aqui..."
      class="text-area"
    ></textarea>
    <app-alert [message]="feedbackMessage" [type]="feedbackType"></app-alert>
  </section>
</main>

<app-ad-banner mode="fake"></app-ad-banner>